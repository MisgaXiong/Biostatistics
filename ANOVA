#双因素有重复方差分析：
#从3种不同原料与3种不同发酵温度中选出某物质较为适宜的条件，每个水平4重复
con<-data.frame(x<-c(41,49,23,25,47,59,50,40,43,35,53,50,11,13,25,24,43,38,33,36,55,38,47,44,6,22,26,18,8,22,18,14,30,33,26,19),A<-gl(3,4,36),B<-gl(3,12,36))
View(con)#检查数据
con.aov<-aov(x~A+B+A:B)
summary(con.aov)
TukeyHSD(con.aov)#多重比较
plot(TukeyHSD(con.aov))
boxplot(x~A+B+A:B,data=con)
#三因素有重复方差分析
gz<-data.frame(x<-c(7.0,6.5,12.8,11.4,22.0,21.8,21.3,20.3,24.2,23.2,13.5,13.8,13.2,14.2,20.8,21.4,19.0,19.6,24.6,23.8,10.7,10.3,12.4,13.2,22.6,21.8,21.3,22.4,24.5,24.2,3.6,1.5,10.7,8.8,4.7,3.4,12.4,10.5,13.6,13.7,4.7,4.9,9.8,10.5,2.7,4.2,12.4,13.2,14.0,14.2,8.7,8.5,9.6,9.7,3.4,4.2,13.0,12.7,14.8,12.6),A<-gl(2,30,60),B<-gl(5,6,60),C<-gl(3,2,60))
gz.aov<-aov(x~A*B*C)
summary(gz.aov)
TukeyHSD(gz.aov)
plot(TukeyHSD(gz.aov))
boxplot(x~A*B*C,data=gz)
